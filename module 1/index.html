<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Local Community Event Portal</title>
  <style>
    /* Internal CSS */
    #welcomeBanner {
      background-color: #007BFF;
      color: white;
      padding: 10px;
      text-align: center;
    }
    .highlight {
      background-color: yellow;
    }
    table img {
      border: 2px solid #333;
      width: 150px;
      height: 100px;
    }
    form {
      margin-top: 20px;
    }
  </style>
  <script>
    // Handle localStorage for event type
    window.onload = function() {
      const savedType = localStorage.getItem("eventType");
      if (savedType) {
        document.getElementById("eventType").value = savedType;
      }
    }

    function validatePhone() {
      const phone = document.getElementById("phone");
      if (!/^\d{10}$/.test(phone.value)) {
        alert("Please enter a 10-digit phone number");
        phone.focus();
      }
    }

    function showFee() {
      const type = document.getElementById("eventType").value;
      localStorage.setItem("eventType", type);
      const fees = {
        music: "$10",
        food: "$5",
        sports: "$8"
      };
      document.getElementById("feeDisplay").textContent = "Fee: " + fees[type];
    }

    function confirmSubmit() {
      document.getElementById("confirmation").value = "Thank you for registering!";
      return false;
    }

    function enlargeImage(img) {
      img.style.transform = "scale(1.5)";
      img.style.transition = "transform 0.3s";
    }

    function countChars() {
      const count = document.getElementById("feedback").value.length;
      document.getElementById("charCount").textContent = count + " characters";
    }

    function videoReady() {
      document.getElementById("videoStatus").textContent = "Video ready to play";
    }

    window.onbeforeunload = function() {
      return "You have unsaved changes. Are you sure you want to leave?";
    }

    function findLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          position => {
            document.getElementById("location").textContent =
              `Latitude: ${position.coords.latitude}, Longitude: ${position.coords.longitude}`;
          },
          error => {
            alert("Geolocation error: " + error.message);
          },
          { enableHighAccuracy: true, timeout: 5000 }
        );
      } else {
        alert("Geolocation is not supported by this browser.");
      }
    }

    function clearPreferences() {
      localStorage.clear();
      sessionStorage.clear();
      alert("Preferences cleared.");
    }
  </script>
</head>
<body>
  <!-- Navigation -->
  <nav>
    <a href="#home">Home</a> |
    <a href="#events">Events</a> |
    <a href="#contact">Contact</a> |
    <a href="help.html" target="_blank">Help</a>
  </nav>

  <!-- Main -->
  <main>
    <section id="home">
      <div id="welcomeBanner">Welcome to the Community Portal! <span style="color:red; font-weight:bold">Special offer!</span></div>
    </section>

    <section id="events">
      <h2 class="highlight">Upcoming Community Events</h2>
      <table>
        <caption>Event Highlights</caption>
        <tr>
          <td><img src="event1.jpg" alt="Event 1" title="Music Fest" ondblclick="enlargeImage(this)"></td>
          <td><img src="event2.jpg" alt="Event 2" title="Food Carnival" ondblclick="enlargeImage(this)"></td>
          <td><img src="event3.jpg" alt="Event 3" title="Sports Meet" ondblclick="enlargeImage(this)"></td>
        </tr>
        <tr>
          <td><img src="event4.jpg" alt="Event 4" title="Art Expo" ondblclick="enlargeImage(this)"></td>
          <td><img src="event5.jpg" alt="Event 5" title="Tech Fair" ondblclick="enlargeImage(this)"></td>
          <td><img src="event6.jpg" alt="Event 6" title="Book Fest" ondblclick="enlargeImage(this)"></td>
        </tr>
      </table>
    </section>

    <section id="register">
      <h2>Register for an Event</h2>
      <form onsubmit="return confirmSubmit()">
        <label>Name: <input type="text" placeholder="Enter your name" required autofocus></label><br>
        <label>Email: <input type="email" placeholder="Enter your email" required></label><br>
        <label>Phone: <input type="text" id="phone" onblur="validatePhone()"></label><br>
        <label>Date: <input type="date" required></label><br>
        <label>Event Type:
          <select id="eventType" onchange="showFee()">
            <option value="music">Music</option>
            <option value="food">Food</option>
            <option value="sports">Sports</option>
          </select>
        </label>
        <p id="feeDisplay"></p>
        <label>Message:<br>
          <textarea id="feedback" onkeyup="countChars()" placeholder="Any additional info"></textarea>
        </label>
        <p id="charCount"></p>
        <br><input type="submit" value="Register">
        <output id="confirmation"></output>
      </form>
    </section>

    <section id="video">
      <h2>Promo Video</h2>
      <video controls oncanplay="videoReady()" width="320" height="240">
        <source src="promo.mp4" type="video/mp4">
        Your browser does not support the video tag.
      </video>
      <p id="videoStatus"></p>
    </section>

    <section id="geo">
      <h2>Find Events Near You</h2>
      <button onclick="findLocation()">Find Nearby Events</button>
      <p id="location"></p>
    </section>

    <section id="preferences">
      <button onclick="clearPreferences()">Clear Preferences</button>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <p class="highlight">&copy; 2025 Local City Council</p>
  </footer>
</body>
</html>